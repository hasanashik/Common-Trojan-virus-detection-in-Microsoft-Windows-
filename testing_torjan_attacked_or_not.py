
port_list=['1', '2', '20', '21', '22', '23', '25', '30', '31', '41', '48', '50', '58', '59', '79', '80', '711', '81', '99', '110', '113', '119', '121', '123', '133', '137', '137', '138', '139', '142', '146', '146', '170', '334', '411', '420', '451', '455', '456', '513', '555', '605', '666', '667', '669', '692', '777', '808', '911', '999', '1000', '1001', '1010', '1011', '1012', '1015', '1016', '1020', '1024', '1025', '1025', '1035', '1042', '1045', '1049', '1050', '1053', '1054', '1080', '1081', '1082', '1083', '1090', '1095', '1097', '1098', '1099', '1150', '1151', '1170', '1200', '1201', '1207', '1208', '1212', '1234', '1243', '1245', '1255', '1256', '1269', '1272', '1313', '1338', '1349', '1394', '1441', '1492', '1524', '1568', '1600', '1703', '1777', '1807', '1966', '1967', '1969', '1981', '1999', '2000', '2001', '2023', '2080', '2115', '2130', '2140', '2140', '2155', '2255', '2283', '2300', '2311', '2330', '2331', '2332', '2333', '2334', '2335', '2336', '2337', '2338', '2339', '2339', '2345', '2565', '2583', '2600', '2716', '2773', '2774', '2801', '2989', '3000', '3024', '3031', '3128', '3129', '3150', '3150', '3456', '3459', '3700', '3777', '3791', '3801', '4000', '4092', '4242', '4321', '4444', '4567', '4590', '4950', '5000', '5001', '5002', '5010', '5011', '5025', '5031', '5032', '5321', '5333', '5343', '5400', '5401', '5402', '5512', '5534', '5550', '5555', '5556', '5557', '5569', '5637', '5638', '5742', '5760', '5880', '5882', '5882', '5882', '5888', '5889', '5889', '6000', '6000', '6000', '6000', '6661', '6666', '6667', '6669', '6670', '6711', '6710', '6713', '6723', '6771', '6776', '6838', '6883', '6912', '6939', '6969', '6970', '7000', '7001', '7215', '7300', '7301', '7306', '7307', '7308', '7424', '7424', '7597', '7626', '7777', '7789', '7891', '7983', '8080', '8787', '8988', '8989', '9000', '9325', '9400', '9872', '9873', '9874', '9875', '9876', '9878', '9989', '9999', '10000', '10005', '10067', '10085', '10086', '10100', '10101', '10167', '10520', '10528', '10607', '10666', '11000', '11050', '11051', '11223', '12076', '12345', '12346', '12349', '12361', '12362', '12363', '12623', '12624', '12631', '12754', '13000', '13010', '13013', '13014', '13223', '13473', '14500', '14501', '14502', '14503', '15000', '15092', '15104', '15382', '15858', '16484', '16660', '16772', '16959', '16969', '17166', '17300', '17449', '17500', '17569', '17593', '17777', '18753', '19864', '20000', '20001', '20002', '20005', '20023', '20034', '20203', '20331', '20432', '20433', '21544', '21554', '22222', '23005', '23006', '23023', '23030', '23432', '23456', '23476', '23476', '23477', '23777', '24000', '25685', '25686', '25982', '26274', '26681', '27374', '27444', '27573', '27665', '28678', '29104', '29363', '29891', '30000', '30001', '30003', '30029', '30100', '30101', '30102', '30103', '30103', '30133', '30303', '30947', '30999', '31335', '31336', '31337', '31337', '31338', '31338', '31787', '31788', '31789', '31790', '31791', '31792', '32001', '32100', '32418', '33270', '33333', '33577', '33777', '33911', '34324', '34444', '34555', '35555', '37237', '37651', '40412', '40421', '40422', '40423', '40425', '40426', '41337', '41666', '44444', '44575', '47262', '49301', '50130', '50505', '50766', '51966', '52317', '53001', '54283', '54320', '54321', '55165', '55166', '57341', '58339', '60000', '60001', '60068', '60411', '61348', '61466', '61603', '63485', '64101', '65000', '65390', '65421', '65432', '65432', '65534', '65535']
from subprocess import check_output
import re
#check_output("dir D:", shell=True).decode()
output=check_output("netstat -a", shell=True).decode()
ports=list()
f=re.findall(':([0-9][0-9]+)',output)
ports=f
    
def returnMatches(a,b):
    new_list = []
    for element in a:
        if element in b:
            new_list.append(element)
    return new_list

#print(port_list)
#print('\n\n\n\n\n\n\nports==========',ports)
final_ports=returnMatches(ports,port_list)
print(final_ports)


from subprocess import check_output
#check_output("dir D:", shell=True).decode()
print(check_output("netstat -aon", shell=True).decode())


print(check_output("netstat -a", shell=True).decode())